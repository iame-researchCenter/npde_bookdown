<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Examples | npde: Open Source R normalised prediction distribution errors</title>
  <meta name="description" content="User’s guide and documentation for npde package" />
  <meta name="generator" content="bookdown 0.23.4 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Examples | npde: Open Source R normalised prediction distribution errors" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="User’s guide and documentation for npde package" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Examples | npde: Open Source R normalised prediction distribution errors" />
  
  <meta name="twitter:description" content="User’s guide and documentation for npde package" />
  

<meta name="author" content="Emmanuelle Comets, Karl Brendel, Marc Cerou, Thi Huyen Tram Nguyen, Romain Leroux, France Mentré" />


<meta name="date" content="2021-09-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="npdePackage.html"/>
<link rel="next" href="graphTypes0.html"/>
<script src="libs/header-attrs-2.9/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">npde R Package Guide</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome to the npde package in R</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#user-guide"><i class="fa fa-check"></i>User Guide</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#legalese"><i class="fa fa-check"></i>Legalese</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="introduction.html"><a href="introduction.html#contents-of-the-bookdown"><i class="fa fa-check"></i><b>1.1</b> Contents of the bookdown</a></li>
<li class="chapter" data-level="1.2" data-path="introduction.html"><a href="introduction.html#citing-npde"><i class="fa fa-check"></i><b>1.2</b> Citing npde</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="installation.html"><a href="installation.html"><i class="fa fa-check"></i><b>2</b> Installation</a>
<ul>
<li class="chapter" data-level="2.1" data-path="installation.html"><a href="installation.html#cran"><i class="fa fa-check"></i><b>2.1</b> <code>CRAN</code></a></li>
<li class="chapter" data-level="2.2" data-path="installation.html"><a href="installation.html#github-build-from-source"><i class="fa fa-check"></i><b>2.2</b> <code>Github</code>: Build from source</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="statisticalMethods.html"><a href="statisticalMethods.html"><i class="fa fa-check"></i><b>3</b> Statistical methods</a>
<ul>
<li class="chapter" data-level="3.1" data-path="statisticalMethods.html"><a href="statisticalMethods.html#models-and-notations"><i class="fa fa-check"></i><b>3.1</b> Models and notations</a></li>
<li class="chapter" data-level="3.2" data-path="statisticalMethods.html"><a href="statisticalMethods.html#computing-pde-and-npde"><i class="fa fa-check"></i><b>3.2</b> Computing pde and npde</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="statisticalMethods.html"><a href="statisticalMethods.html#prediction-discrepancies-pd"><i class="fa fa-check"></i><b>3.2.1</b> Prediction discrepancies (pd)</a></li>
<li class="chapter" data-level="3.2.2" data-path="statisticalMethods.html"><a href="statisticalMethods.html#smoothing-the-distribution"><i class="fa fa-check"></i><b>3.2.2</b> Smoothing the distribution</a></li>
<li class="chapter" data-level="3.2.3" data-path="statisticalMethods.html"><a href="statisticalMethods.html#normalised-prediction-distribution-errors-npde"><i class="fa fa-check"></i><b>3.2.3</b> Normalised prediction distribution errors (npde)</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="statisticalMethods.html"><a href="statisticalMethods.html#decorrelation"><i class="fa fa-check"></i><b>3.3</b> Decorrelating the data to obtain <span class="math inline">\(\mathrm{pde}\)</span></a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="statisticalMethods.html"><a href="statisticalMethods.html#decorrelation-methods"><i class="fa fa-check"></i><b>3.3.1</b> Decorrelation methods</a></li>
<li class="chapter" data-level="3.3.2" data-path="statisticalMethods.html"><a href="statisticalMethods.html#choosing-a-decorrelation-method"><i class="fa fa-check"></i><b>3.3.2</b> Choosing a decorrelation method</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="statisticalMethods.html"><a href="statisticalMethods.html#censoring-methods"><i class="fa fa-check"></i><b>3.4</b> Censoring methods</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="statisticalMethods.html"><a href="statisticalMethods.html#choosing-the-method-to-handle-bql-data"><i class="fa fa-check"></i><b>3.4.1</b> Choosing the method to handle BQL data</a></li>
<li class="chapter" data-level="3.4.2" data-path="statisticalMethods.html"><a href="statisticalMethods.html#imputation-of-bql-data-using-the-cumulative-distribution-function"><i class="fa fa-check"></i><b>3.4.2</b> Imputation of BQL data using the cumulative distribution function</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="statisticalMethods.html"><a href="statisticalMethods.html#tests"><i class="fa fa-check"></i><b>3.5</b> Tests</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="statisticalMethods.html"><a href="statisticalMethods.html#tests-on-the-distribution-of-npde"><i class="fa fa-check"></i><b>3.5.1</b> Tests on the distribution of npde</a></li>
<li class="chapter" data-level="3.5.2" data-path="statisticalMethods.html"><a href="statisticalMethods.html#tests-for-covariate-models"><i class="fa fa-check"></i><b>3.5.2</b> Tests for covariate models</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="graphmethods.html"><a href="graphmethods.html"><i class="fa fa-check"></i><b>4</b> Diagnostic graphs</a>
<ul>
<li class="chapter" data-level="4.1" data-path="graphmethods.html"><a href="graphmethods.html#assessing-the-distribution-of-npde"><i class="fa fa-check"></i><b>4.1</b> Assessing the distribution of npde</a></li>
<li class="chapter" data-level="4.2" data-path="graphmethods.html"><a href="graphmethods.html#vpc"><i class="fa fa-check"></i><b>4.2</b> VPC</a></li>
<li class="chapter" data-level="4.3" data-path="graphmethods.html"><a href="graphmethods.html#probability-of-being-under-the-loq"><i class="fa fa-check"></i><b>4.3</b> Probability of being under the LOQ</a></li>
<li class="chapter" data-level="4.4" data-path="graphmethods.html"><a href="graphmethods.html#graph-features"><i class="fa fa-check"></i><b>4.4</b> Graph features</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="graphmethods.html"><a href="graphmethods.html#stratification"><i class="fa fa-check"></i><b>4.4.1</b> Stratification</a></li>
<li class="chapter" data-level="4.4.2" data-path="graphmethods.html"><a href="graphmethods.html#prediction-intervals"><i class="fa fa-check"></i><b>4.4.2</b> Prediction intervals</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="graphmethods.html"><a href="graphmethods.html#graphs-for-covariate-models"><i class="fa fa-check"></i><b>4.5</b> Graphs for covariate models</a></li>
<li class="chapter" data-level="4.6" data-path="graphmethods.html"><a href="graphmethods.html#graphs-with-a-reference-profile"><i class="fa fa-check"></i><b>4.6</b> Graphs with a reference profile</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="graphmethods.html"><a href="graphmethods.html#non-parametric-construction-of-mathrmtnpde"><i class="fa fa-check"></i><b>4.6.1</b> Non-parametric construction of <span class="math inline">\(\mathrm{tnpde}\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="npdePackage.html"><a href="npdePackage.html"><i class="fa fa-check"></i><b>5</b> Using the npde package</a>
<ul>
<li class="chapter" data-level="5.1" data-path="npdePackage.html"><a href="npdePackage.html#theophylline-data"><i class="fa fa-check"></i><b>5.1</b> Theophylline data</a></li>
<li class="chapter" data-level="5.2" data-path="npdePackage.html"><a href="npdePackage.html#preparation-of-the-input"><i class="fa fa-check"></i><b>5.2</b> Preparation of the input</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="npdePackage.html"><a href="npdePackage.html#observed-data"><i class="fa fa-check"></i><b>5.2.1</b> Observed data</a></li>
<li class="chapter" data-level="5.2.2" data-path="npdePackage.html"><a href="npdePackage.html#simulated-data"><i class="fa fa-check"></i><b>5.2.2</b> Simulated data</a></li>
<li class="chapter" data-level="5.2.3" data-path="npdePackage.html"><a href="npdePackage.html#number-of-simulations"><i class="fa fa-check"></i><b>5.2.3</b> Number of simulations</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="npdePackage.html"><a href="npdePackage.html#execution"><i class="fa fa-check"></i><b>5.3</b> Execution</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="npdePackage.html"><a href="npdePackage.html#interactive-execution"><i class="fa fa-check"></i><b>5.3.1</b> Interactive execution</a></li>
<li class="chapter" data-level="5.3.2" data-path="npdePackage.html"><a href="npdePackage.html#non-interactive-execution"><i class="fa fa-check"></i><b>5.3.2</b> Non-interactive execution</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="npdePackage.html"><a href="npdePackage.html#results"><i class="fa fa-check"></i><b>5.4</b> Results</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="npdePackage.html"><a href="npdePackage.html#value"><i class="fa fa-check"></i><b>5.4.1</b> Value</a></li>
<li class="chapter" data-level="5.4.2" data-path="npdePackage.html"><a href="npdePackage.html#tests-1"><i class="fa fa-check"></i><b>5.4.2</b> Tests</a></li>
<li class="chapter" data-level="5.4.3" data-path="npdePackage.html"><a href="npdePackage.html#default-graphs"><i class="fa fa-check"></i><b>5.4.3</b> Default graphs</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="examples.html"><a href="examples.html"><i class="fa fa-check"></i><b>6</b> Examples</a>
<ul>
<li class="chapter" data-level="6.1" data-path="examples.html"><a href="examples.html#load-the-libraries-and-the-npde-package"><i class="fa fa-check"></i><b>6.1</b> Load the libraries and the npde package</a></li>
<li class="chapter" data-level="6.2" data-path="examples.html"><a href="examples.html#load-the-data-and-the-simulated-data"><i class="fa fa-check"></i><b>6.2</b> Load the data and the simulated data</a>
<ul>
<li class="chapter" data-level="6.2.1" data-path="examples.html"><a href="examples.html#warfarin-description-of-the-data"><i class="fa fa-check"></i><b>6.2.1</b> Warfarin : description of the data</a></li>
</ul></li>
<li class="chapter" data-level="6.3" data-path="examples.html"><a href="examples.html#compute-the-normalised-prediction-distribution-errors"><i class="fa fa-check"></i><b>6.3</b> Compute the normalised prediction distribution errors</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="examples.html"><a href="examples.html#description-of-the-output-wcov"><i class="fa fa-check"></i><b>6.3.1</b> Description of the output wcov</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="examples.html"><a href="examples.html#data"><i class="fa fa-check"></i><b>6.4</b> Data</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="examples.html"><a href="examples.html#plot-the-data-for-the-base-model"><i class="fa fa-check"></i><b>6.4.1</b> Plot the data for the base model</a></li>
<li class="chapter" data-level="6.4.2" data-path="examples.html"><a href="examples.html#default-plot-for-the-base-model"><i class="fa fa-check"></i><b>6.4.2</b> Default plot for the base model</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="examples.html"><a href="examples.html#covariate-model"><i class="fa fa-check"></i><b>6.5</b> Covariate model</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="examples.html"><a href="examples.html#default-plots"><i class="fa fa-check"></i><b>6.5.1</b> Default plots</a></li>
<li class="chapter" data-level="6.5.2" data-path="examples.html"><a href="examples.html#scatterplots-of-npd"><i class="fa fa-check"></i><b>6.5.2</b> Scatterplots of npd</a></li>
<li class="chapter" data-level="6.5.3" data-path="examples.html"><a href="examples.html#plot-npd-as-boxplots-for-each-covariate-category"><i class="fa fa-check"></i><b>6.5.3</b> Plot npd as boxplots for each covariate category</a></li>
<li class="chapter" data-level="6.5.4" data-path="examples.html"><a href="examples.html#diagnostic-plots-for-covariates"><i class="fa fa-check"></i><b>6.5.4</b> Diagnostic plots for covariates</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="examples.html"><a href="examples.html#reference-profile"><i class="fa fa-check"></i><b>6.6</b> Reference profile</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="examples.html"><a href="examples.html#reference-plot-using-one-subject"><i class="fa fa-check"></i><b>6.6.1</b> Reference plot using one subject</a></li>
<li class="chapter" data-level="6.6.2" data-path="examples.html"><a href="examples.html#reference-plot-using-all-subjects"><i class="fa fa-check"></i><b>6.6.2</b> Reference plot using all subjects</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="examples.html"><a href="examples.html#computing-npde-in-the-presence-of-bql-data"><i class="fa fa-check"></i><b>6.7</b> Computing npde in the presence of BQL data</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="examples.html"><a href="examples.html#data-1"><i class="fa fa-check"></i><b>6.7.1</b> Data</a></li>
<li class="chapter" data-level="6.7.2" data-path="examples.html"><a href="examples.html#comparing-the-censoring-methods"><i class="fa fa-check"></i><b>6.7.2</b> Comparing the censoring methods</a></li>
<li class="chapter" data-level="6.7.3" data-path="examples.html"><a href="examples.html#vpc-plots"><i class="fa fa-check"></i><b>6.7.3</b> VPC plots</a></li>
<li class="chapter" data-level="6.7.4" data-path="examples.html"><a href="examples.html#scatterplots"><i class="fa fa-check"></i><b>6.7.4</b> Scatterplots</a></li>
<li class="chapter" data-level="6.7.5" data-path="examples.html"><a href="examples.html#plot-for-mathbbpyloq"><i class="fa fa-check"></i><b>6.7.5</b> Plot for <span class="math inline">\(\mathbb{P}(Y&lt;LOQ)\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="graphTypes0.html"><a href="graphTypes0.html"><i class="fa fa-check"></i><b>7</b> Types of graphs in the npde library</a>
<ul>
<li class="chapter" data-level="7.1" data-path="graphTypes0.html"><a href="graphTypes0.html#plot-type"><i class="fa fa-check"></i><b>7.1</b> Plot type</a></li>
<li class="chapter" data-level="7.2" data-path="graphTypes0.html"><a href="graphTypes0.html#specific-plot-functions"><i class="fa fa-check"></i><b>7.2</b> Specific plot functions</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="graphTypes0.html"><a href="graphTypes0.html#binning"><i class="fa fa-check"></i><b>7.2.1</b> Binning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="graphOptions.html"><a href="graphOptions.html"><i class="fa fa-check"></i><b>8</b> Tayloring options for graphs</a>
<ul>
<li class="chapter" data-level="8.1" data-path="graphOptions.html"><a href="graphOptions.html#setting-options-for-graphs"><i class="fa fa-check"></i><b>8.1</b> Setting options for graphs</a></li>
<li class="chapter" data-level="8.2" data-path="graphOptions.html"><a href="graphOptions.html#layout-titles-and-axes"><i class="fa fa-check"></i><b>8.2</b> Layout, titles and axes</a></li>
<li class="chapter" data-level="8.3" data-path="graphOptions.html"><a href="graphOptions.html#parameters-controlling-content."><i class="fa fa-check"></i><b>8.3</b> Parameters controlling content.</a></li>
<li class="chapter" data-level="8.4" data-path="graphOptions.html"><a href="graphOptions.html#graphical-options-for-vpc-and-residual-plots."><i class="fa fa-check"></i><b>8.4</b> Graphical options for VPC and residual plots.</a></li>
<li class="chapter" data-level="8.5" data-path="graphOptions.html"><a href="graphOptions.html#colours-transparency-line-types-and-symbols."><i class="fa fa-check"></i><b>8.5</b> Colours, transparency, line types and symbols.</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="graphTypes.html"><a href="graphTypes.html"><i class="fa fa-check"></i><b>9</b> Types of graphs in the npde library</a>
<ul>
<li class="chapter" data-level="9.1" data-path="graphTypes.html"><a href="graphTypes.html#plot-type-1"><i class="fa fa-check"></i><b>9.1</b> Plot type</a></li>
<li class="chapter" data-level="9.2" data-path="graphTypes.html"><a href="graphTypes.html#specific-plot-functions-1"><i class="fa fa-check"></i><b>9.2</b> Specific plot functions</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="graphTypes.html"><a href="graphTypes.html#binning-1"><i class="fa fa-check"></i><b>9.2.1</b> Binning</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="packageStructure.html"><a href="packageStructure.html"><i class="fa fa-check"></i><b>10</b> Structure of the npde package</a>
<ul>
<li class="chapter" data-level="10.0.1" data-path="packageStructure.html"><a href="packageStructure.html#online-help"><i class="fa fa-check"></i><b>10.0.1</b> Online help</a></li>
<li class="chapter" data-level="10.1" data-path="packageStructure.html"><a href="packageStructure.html#errors-during-execution"><i class="fa fa-check"></i><b>10.1</b> Errors during execution</a></li>
<li class="chapter" data-level="10.2" data-path="packageStructure.html"><a href="packageStructure.html#functions-in-the-npde-package"><i class="fa fa-check"></i><b>10.2</b> Functions in the <strong>npde</strong> package</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>11</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./"><strong>npde</strong>: Open Source R normalised prediction distribution errors</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="examples" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Examples</h1>
<div id="load-the-libraries-and-the-npde-package" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Load the libraries and the npde package</h2>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="examples.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Libraries</span></span>
<span id="cb23-2"><a href="examples.html#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>( gridExtra )</span>
<span id="cb23-3"><a href="examples.html#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>( ggplot2 )</span>
<span id="cb23-4"><a href="examples.html#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>( grid )</span>
<span id="cb23-5"><a href="examples.html#cb23-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>( devtools )</span>
<span id="cb23-6"><a href="examples.html#cb23-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>( mclust )</span>
<span id="cb23-7"><a href="examples.html#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>( npde )</span></code></pre></div>
</div>
<div id="load-the-data-and-the-simulated-data" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Load the data and the simulated data</h2>
<p>Github repository for the data
<a href="https://github.com/ecomets/npde30/tree/main/keep/data" class="uri">https://github.com/ecomets/npde30/tree/main/keep/data</a></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="examples.html#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Data </span></span>
<span id="cb24-2"><a href="examples.html#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>( warfarin )</span>
<span id="cb24-3"><a href="examples.html#cb24-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>( simwarfarinCov )</span>
<span id="cb24-4"><a href="examples.html#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="examples.html#cb24-5" aria-hidden="true" tabindex="-1"></a>fullDatDir <span class="ot">=</span> <span class="fu">paste0</span>(<span class="fu">getwd</span>(),<span class="st">&quot;/data/&quot;</span>)</span>
<span id="cb24-6"><a href="examples.html#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="examples.html#cb24-7" aria-hidden="true" tabindex="-1"></a>simwarfarinBase <span class="ot">=</span> <span class="fu">read.table</span>( <span class="fu">file.path</span>( fullDatDir, <span class="st">&quot;simwarfarinBase.tab&quot;</span> ), <span class="at">header =</span> <span class="cn">TRUE</span> )</span></code></pre></div>
<div id="warfarin-description-of-the-data" class="section level3" number="6.2.1">
<h3><span class="header-section-number">6.2.1</span> Warfarin : description of the data</h3>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="examples.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Warfarin</span></span>
<span id="cb25-2"><a href="examples.html#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>( warfarin )</span></code></pre></div>
<pre><code>##    id time amt   dv dvid   wt sex age
## 1 100  0.5 100  0.0    1 66.7   1  50
## 2 100  1.0 100  1.9    1 66.7   1  50
## 3 100  2.0 100  3.3    1 66.7   1  50
## 4 100  3.0 100  6.6    1 66.7   1  50
## 5 100  6.0 100  9.1    1 66.7   1  50
## 6 100  9.0 100 10.8    1 66.7   1  50</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="examples.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Warfarin with base model</span></span>
<span id="cb27-2"><a href="examples.html#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>( simwarfarinBase )</span></code></pre></div>
<pre><code>##    id xsim        ysim
## 1 100  0.5 -0.08832318
## 2 100  1.0  0.35687036
## 3 100  2.0  6.36276558
## 4 100  3.0  8.88972144
## 5 100  6.0 11.90216904
## 6 100  9.0 11.93056720</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="examples.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Warfarin with covariate model</span></span>
<span id="cb29-2"><a href="examples.html#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>( simwarfarinCov )</span></code></pre></div>
<pre><code>##    id xsim        ysim
## 1 100  0.5 -0.07684729
## 2 100  1.0  0.48476881
## 3 100  2.0  6.86641424
## 4 100  3.0 11.54095368
## 5 100  6.0 11.59647752
## 6 100  9.0 10.04260881</code></pre>
</div>
</div>
<div id="compute-the-normalised-prediction-distribution-errors" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Compute the normalised prediction distribution errors</h2>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="examples.html#cb31-1" aria-hidden="true" tabindex="-1"></a>wbase <span class="ot">&lt;-</span> <span class="fu">autonpde</span>( <span class="at">namobs =</span> warfarin, <span class="at">namsim =</span> simwarfarinBase, </span>
<span id="cb31-2"><a href="examples.html#cb31-2" aria-hidden="true" tabindex="-1"></a>                   <span class="at">iid =</span> <span class="dv">1</span>, <span class="at">ix =</span> <span class="dv">2</span>, <span class="at">iy =</span> <span class="dv">4</span>, <span class="at">icov =</span> <span class="fu">c</span>( <span class="dv">3</span>,<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span> ), <span class="at">namsav =</span> <span class="st">&quot;warfBase&quot;</span>, </span>
<span id="cb31-3"><a href="examples.html#cb31-3" aria-hidden="true" tabindex="-1"></a>                   <span class="at">units =</span> <span class="fu">list</span>( <span class="at">x =</span> <span class="st">&quot;hr&quot;</span>, <span class="at">y =</span> <span class="st">&quot;ug/L&quot;</span>, <span class="at">covariates =</span> <span class="fu">c</span>( <span class="st">&quot;mg&quot;</span>,<span class="st">&quot;kg&quot;</span>,<span class="st">&quot;-&quot;</span>,<span class="st">&quot;yr&quot;</span> ) ) )</span></code></pre></div>
<pre><code>## ---------------------------------------------
## Distribution of npde :
##       nb of obs: 247 
##            mean= 0.03419   (SE= 0.06 )
##        variance= 0.8753   (SE= 0.079 )
##        skewness= -0.1149 
##        kurtosis= -0.0497 
## ---------------------------------------------
## Statistical tests (adjusted p-values):
##   t-test                : 1
##   Fisher variance test  : 0.471
##   SW test of normality  : 1
##   Global test           : 0.471
## ---
## Signif. codes: &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 
## ---------------------------------------------</code></pre>
<p><img src="npde_bookdown_files/figure-html/warfarin_autonpde-1.png" width="672" /></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="examples.html#cb33-1" aria-hidden="true" tabindex="-1"></a>wcov <span class="ot">&lt;-</span> <span class="fu">autonpde</span>( <span class="at">namobs =</span> warfarin, <span class="at">namsim =</span> simwarfarinCov, </span>
<span id="cb33-2"><a href="examples.html#cb33-2" aria-hidden="true" tabindex="-1"></a>                  <span class="at">iid =</span> <span class="dv">1</span>, <span class="at">ix =</span> <span class="dv">2</span>, <span class="at">iy =</span> <span class="dv">4</span>, <span class="at">icov =</span> <span class="fu">c</span>( <span class="dv">3</span>,<span class="dv">6</span><span class="sc">:</span><span class="dv">8</span> ), <span class="at">namsav =</span> <span class="st">&quot;warfCov&quot;</span>, </span>
<span id="cb33-3"><a href="examples.html#cb33-3" aria-hidden="true" tabindex="-1"></a>                  <span class="at">units =</span> <span class="fu">list</span>( <span class="at">x =</span> <span class="st">&quot;h&quot;</span>, <span class="at">y =</span> <span class="st">&quot;mg/L&quot;</span>, <span class="at">covariates =</span> <span class="fu">c</span>( <span class="st">&quot;mg&quot;</span>,<span class="st">&quot;kg&quot;</span>,<span class="st">&quot;-&quot;</span>,<span class="st">&quot;yr&quot;</span> ) ) )</span></code></pre></div>
<pre><code>## ---------------------------------------------
## Distribution of npde :
##       nb of obs: 247 
##            mean= 0.02928   (SE= 0.059 )
##        variance= 0.8549   (SE= 0.077 )
##        skewness= -0.07211 
##        kurtosis= -0.4172 
## ---------------------------------------------
## Statistical tests (adjusted p-values):
##   t-test                : 1
##   Fisher variance test  : 0.288
##   SW test of normality  : 1
##   Global test           : 0.288
## ---
## Signif. codes: &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 
## ---------------------------------------------</code></pre>
<p><img src="npde_bookdown_files/figure-html/warfarin_autonpde-2.png" width="672" /></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="examples.html#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">show</span>( wbase )</span></code></pre></div>
<pre><code>## Object of class NpdeObject
## -----------------------------------------
## ----        Component data           ----
## -----------------------------------------
## Object of class NpdeData
##     Structured data: dv ~ time | id 
##     Covariates: amt wt sex age 
## This object has the following components:
##      data: data
##      with 32 subjects
##       247 observations
## The data has the following components
##      X: time (hr) 
##      Y: dv (ug/L) 
##      missing data: mdv  (1=missing)
## -----------------------------------------
## ----        Component results        ----
## -----------------------------------------
## Object of class NpdeRes
##   containing the following elements:
##     predictions (ypred)
##     prediction discrepancies (pd)
##     normalised prediction distribution errors (npde)
##     completed responses (ycomp) for censored data
##     decorrelated responses (ydobs)
##   the dataframe has  247 non-missing observations .
## First 10 lines of results, removing missing observations:
##         ypred ycomp    pd       ydobs       npde
## 1   0.5814627   0.0 0.359 -0.43862113 -0.3611330
## 2   3.1220995   1.9 0.454 -0.05116685  0.1636585
## 3   8.4386880   3.3 0.126 -1.35607837 -1.4985131
## 4  11.2936700   6.6 0.140  0.04661369  0.1560419
## 5  12.6249280   9.1 0.127 -0.56691520 -0.5417366
## 6  11.7504645  10.8 0.355  0.89677342  0.9230138
## 7  10.8386881   8.6 0.141 -1.08057832 -1.1358962
## 8   8.5881834   5.6 0.026 -1.89143682 -1.8521799
## 9   7.0369975   4.0 0.019 -1.06275059 -1.0278933
## 10  5.7174611   2.7 0.017 -0.60300349 -0.5947658</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="examples.html#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>( wbase )</span></code></pre></div>
<pre><code>## Object of class NpdeObject
## -----------------------------------
## ----          Data             ----
## -----------------------------------
## Object of class NpdeData
##     longitudinal data
##     Structured data: dv ~ time | id 
##     predictor: time (hr) 
##     covariates: amt (mg), wt (kg), sex (-), age (yr) 
## Dataset characteristics:
##     number of subjects:     32 
##     number of non-missing observations: 247 
##     average/min/max nb obs: 7.72  /  6  /  13 
## First 10 lines of data:
##    index  id time   dv amt   wt sex age mdv
## 1      1 100  0.5  0.0 100 66.7   1  50   0
## 2      1 100  1.0  1.9 100 66.7   1  50   0
## 3      1 100  2.0  3.3 100 66.7   1  50   0
## 4      1 100  3.0  6.6 100 66.7   1  50   0
## 5      1 100  6.0  9.1 100 66.7   1  50   0
## 6      1 100  9.0 10.8 100 66.7   1  50   0
## 7      1 100 12.0  8.6 100 66.7   1  50   0
## 8      1 100 24.0  5.6 100 66.7   1  50   0
## 9      1 100 36.0  4.0 100 66.7   1  50   0
## 10     1 100 48.0  2.7 100 66.7   1  50   0
## 
## Summary of original data:
##     vector of predictor time 
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    0.50   24.00   48.00   50.76   72.00  120.00 
##     vector of response dv 
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   0.000   3.200   6.000   6.346   8.850  17.600 
## -----------------------------------
## ----         Key options       ----
## -----------------------------------
## Methods
##     compute normalised prediction discrepancies (npd):  yes 
##     compute normalised prediction distribution errors (npde):  yes 
##     method for decorrelation:  Cholesky decomposition (upper triangular) 
##     method to treat censored data:  Impute pd* and compute y* as F-1(pd*) 
## Input/output
##     verbose (prints a message for each new subject):  FALSE 
##     save the results to a file, save graphs: TRUE 
##     type of graph (eps=postscript, pdf=adobe PDF, jpeg, png): eps 
##     file where results should be saved:  warfBase.npde 
##     file where graphs should be saved:  warfBase.eps 
## -----------------------------------
## ----      Results      ----
## -----------------------------------
## Object of class NpdeRes
##     resulting from a call to npde or autonpde
##     containing the following elements:
##     predictions (ypred)
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.4257  3.1100  6.1058  6.3002  8.5267 16.8707 
##     prediction discrepancies (pd)
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.0030  0.3115  0.5670  0.5344  0.7615  0.9995 
##     normalised prediction distribution errors (npde)
##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## -2.29037 -0.57258  0.05768  0.03419  0.71437  2.87816 
##     completed responses (ycomp) for censored data
##     decorrelated responses (ydobs)
##   the dataframe has  247 non-missing observations .</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="examples.html#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>( wbase )</span></code></pre></div>
<pre><code>## Object of class NpdeObject containing the following main components
##    data: data
##        N= 32 subjects
##        ntot.obs= 247 non-missing observations
##         subject id: id 
##         predictor (X): time 
##         response (Y): dv 
##         covariates: amt wt sex age 
##    sim.data: simulated data: 
##         number of replications: nrep= 1000 
##    results: results of the computation
##         ypred: individual predictions (E_i(f(theta_i,x)))
##         pd: prediction discrepancies
##         npde: normalised prediction distribution errors
##         ycomp: imputed responses for censored data
##         ploq: probability of being &lt;LOQ for each observation
##    options: options for computations
##    prefs: options for graphs</code></pre>
<div id="description-of-the-output-wcov" class="section level3" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> Description of the output wcov</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="examples.html#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wcov</span></span>
<span id="cb41-2"><a href="examples.html#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>( wcov )</span></code></pre></div>
<pre><code>## Object of class NpdeData
##     Structured data: dv ~ time | id 
##     Covariates: amt wt sex age 
## This object has the following components:
##      data: data
##      with 32 subjects
##       247 observations
## The data has the following components
##      X: time (h) 
##      Y: dv (mg/L) 
##      missing data: mdv  (1=missing)</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="examples.html#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wcov slots</span></span>
<span id="cb43-2"><a href="examples.html#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">slotNames</span>( wcov )</span></code></pre></div>
<pre><code>## [1] &quot;data&quot;     &quot;results&quot;  &quot;sim.data&quot; &quot;options&quot;  &quot;prefs&quot;</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="examples.html#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wcov covariates</span></span>
<span id="cb45-2"><a href="examples.html#cb45-2" aria-hidden="true" tabindex="-1"></a>wcov<span class="sc">@</span>data<span class="sc">@</span>name.covariates</span></code></pre></div>
<pre><code>## [1] &quot;amt&quot; &quot;wt&quot;  &quot;sex&quot; &quot;age&quot;</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="examples.html#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wcov graphical options</span></span>
<span id="cb47-2"><a href="examples.html#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="co">#wcov@prefs</span></span></code></pre></div>
</div>
</div>
<div id="data" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> Data</h2>
<div id="plot-the-data-for-the-base-model" class="section level3" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> Plot the data for the base model</h3>
<p><code>plot.type = "data"</code> : Plots the observed data in the dataset</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="examples.html#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="co"># wbase model</span></span>
<span id="cb48-2"><a href="examples.html#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( wbase, <span class="at">plot.type =</span> <span class="st">&quot;data&quot;</span> )</span></code></pre></div>
<p><img src="npde_bookdown_files/figure-html/warfarin_wbase_plot_data-1.png" width="672" /></p>
</div>
<div id="default-plot-for-the-base-model" class="section level3" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Default plot for the base model</h3>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="examples.html#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="co"># base model</span></span>
<span id="cb49-2"><a href="examples.html#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( wbase, <span class="at">which =</span> <span class="st">&quot;npde&quot;</span> )</span></code></pre></div>
<p><img src="npde_bookdown_files/figure-html/warfarin_base_plot_default-1.png" width="672" /></p>
<p><code>plot.type = "hist"</code> Histogram</p>
<p><code>plot.type = qqplot</code> QQ-plot of the npde versus its theoretical distribution</p>
<p><code>plot.type = x.scatter</code> Scatterplot of the npde versus the predictor</p>
<p><code>plot.type = pred.scatter</code> Scatterplot of the npde versus the population predicted values</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="examples.html#cb50-1" aria-hidden="true" tabindex="-1"></a>hist <span class="ot">=</span> <span class="fu">plot</span>( wbase, <span class="at">plot.type =</span> <span class="st">&quot;hist&quot;</span>, <span class="at">which =</span> <span class="st">&quot;npde&quot;</span> )</span>
<span id="cb50-2"><a href="examples.html#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="examples.html#cb50-3" aria-hidden="true" tabindex="-1"></a>qqplot <span class="ot">=</span> <span class="fu">plot</span>( wbase, <span class="at">plot.type =</span> <span class="st">&quot;qqplot&quot;</span>, <span class="at">which =</span> <span class="st">&quot;npde&quot;</span> )</span>
<span id="cb50-4"><a href="examples.html#cb50-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-5"><a href="examples.html#cb50-5" aria-hidden="true" tabindex="-1"></a>x_scatter <span class="ot">=</span> <span class="fu">plot</span>( wbase, <span class="at">plot.type =</span> <span class="st">&quot;x.scatter&quot;</span>, <span class="at">which =</span> <span class="st">&quot;npde&quot;</span> )</span>
<span id="cb50-6"><a href="examples.html#cb50-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-7"><a href="examples.html#cb50-7" aria-hidden="true" tabindex="-1"></a>pred_scatter <span class="ot">=</span> <span class="fu">plot</span>( wbase, <span class="at">plot.type =</span> <span class="st">&quot;pred.scatter&quot;</span>, <span class="at">which =</span> <span class="st">&quot;npde&quot;</span> )</span>
<span id="cb50-8"><a href="examples.html#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="examples.html#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>( <span class="at">grobs =</span> <span class="fu">list</span>( hist, qqplot ), <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span> )</span></code></pre></div>
<p><img src="npde_bookdown_files/figure-html/warfarin_base_plot_default_each-1.png" width="672" /></p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="examples.html#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>( <span class="at">grobs =</span> <span class="fu">list</span>( x_scatter, pred_scatter ), <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span> )</span></code></pre></div>
<p><img src="npde_bookdown_files/figure-html/warfarin_base_plot_default_each-2.png" width="672" /></p>
</div>
</div>
<div id="covariate-model" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Covariate model</h2>
<div id="default-plots" class="section level3" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Default plots</h3>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="examples.html#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># covariate model</span></span>
<span id="cb52-2"><a href="examples.html#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( wcov , <span class="at">which =</span> <span class="st">&quot;npde&quot;</span>)</span></code></pre></div>
<p><img src="npde_bookdown_files/figure-html/warfarin_cov_plot_default-1.png" width="672" /></p>
</div>
<div id="scatterplots-of-npd" class="section level3" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Scatterplots of npd</h3>
<p><code>plot.type = "x.scatter"</code> : Scatterplot of the npd versus the predictor</p>
<p><code>covsplit = TRUE</code> : split by categories</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="examples.html#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Splitting npde vs time plots by covariates</span></span>
<span id="cb53-2"><a href="examples.html#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( wcov, <span class="at">plot.type =</span> <span class="st">&quot;x.scatter&quot;</span>, <span class="at">covsplit =</span> <span class="cn">TRUE</span>, <span class="at">which.cov =</span> <span class="fu">c</span>( <span class="st">&quot;wt&quot;</span> ) )</span></code></pre></div>
<p><img src="npde_bookdown_files/figure-html/warfarin_cov_scatter_split_covariates-1.png" width="672" /></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="examples.html#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot( wcov, plot.type = &quot;x.scatter&quot;, covsplit = TRUE, which.cov = c( &quot;wt&quot;,&quot;sex&quot; ) )</span></span>
<span id="cb54-2"><a href="examples.html#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="co"># plot( wcov, plot.type = &quot;x.scatter&quot;, covsplit = TRUE, which.cov = c( &quot;wt&quot; ), which = &quot;pd&quot; )</span></span>
<span id="cb54-3"><a href="examples.html#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot( wcov, plot.type = &quot;x.scatter&quot;, covsplit = TRUE, which.cov = c( &quot;wt&quot; ), which = &quot;npde&quot; )</span></span></code></pre></div>
</div>
<div id="plot-npd-as-boxplots-for-each-covariate-category" class="section level3" number="6.5.3">
<h3><span class="header-section-number">6.5.3</span> Plot npd as boxplots for each covariate category</h3>
<p><code>plot.type = "covariates"</code> npd represented as boxplots for each covariate category</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="examples.html#cb55-1" aria-hidden="true" tabindex="-1"></a>wt.covariate.boxplot <span class="ot">&lt;-</span> <span class="fu">plot</span>( wcov, <span class="at">plot.type =</span> <span class="st">&quot;covariates&quot;</span>, <span class="at">which.cov =</span> <span class="fu">c</span>( <span class="st">&quot;wt&quot;</span> ) )</span>
<span id="cb55-2"><a href="examples.html#cb55-2" aria-hidden="true" tabindex="-1"></a>sex.covariate.boxplot <span class="ot">&lt;-</span> <span class="fu">plot</span>( wcov, <span class="at">plot.type =</span> <span class="st">&quot;covariates&quot;</span>, <span class="at">which.cov =</span> <span class="fu">c</span>( <span class="st">&quot;sex&quot;</span> ) )</span>
<span id="cb55-3"><a href="examples.html#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="examples.html#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="co"># grid plot</span></span>
<span id="cb55-5"><a href="examples.html#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>( <span class="at">grobs =</span> <span class="fu">list</span>( wt.covariate.boxplot[[<span class="dv">1</span>]], sex.covariate.boxplot[[<span class="dv">1</span>]] ), </span>
<span id="cb55-6"><a href="examples.html#cb55-6" aria-hidden="true" tabindex="-1"></a>              <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span> )</span></code></pre></div>
<p><img src="npde_bookdown_files/figure-html/warfarin_cov_scatter_split_covariates_box_plot-1.png" width="672" /></p>
</div>
<div id="diagnostic-plots-for-covariates" class="section level3" number="6.5.4">
<h3><span class="header-section-number">6.5.4</span> Diagnostic plots for covariates</h3>
<p><code>plot.type = "cov.scatter"</code> : Scatterplot of the npd versus covariates</p>
<p><code>plot.type = "covariates"</code> : Boxplots for each covariate category</p>
<p><code>plot.type = "ecdf"</code> : Empirical distribution function</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="examples.html#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># cov.scatter</span></span>
<span id="cb56-2"><a href="examples.html#cb56-2" aria-hidden="true" tabindex="-1"></a>xwt.covscatt <span class="ot">&lt;-</span> <span class="fu">plot</span>( wcov, <span class="at">plot.type =</span> <span class="st">&quot;cov.scatter&quot;</span>, <span class="at">which.cov =</span> <span class="st">&quot;wt&quot;</span>, <span class="at">bin.method =</span> <span class="st">&quot;optimal&quot;</span> )</span>
<span id="cb56-3"><a href="examples.html#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="examples.html#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ecdf</span></span>
<span id="cb56-5"><a href="examples.html#cb56-5" aria-hidden="true" tabindex="-1"></a>xwt.ecdf <span class="ot">&lt;-</span> <span class="fu">plot</span>( wcov, <span class="at">plot.type =</span> <span class="st">&quot;ecdf&quot;</span>, <span class="at">covsplit =</span> <span class="cn">TRUE</span>, <span class="at">which.cov =</span> <span class="st">&quot;wt&quot;</span> )</span>
<span id="cb56-6"><a href="examples.html#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="examples.html#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># x.scatter</span></span>
<span id="cb56-8"><a href="examples.html#cb56-8" aria-hidden="true" tabindex="-1"></a>xsex.covscatt <span class="ot">&lt;-</span>  <span class="fu">plot</span>( wcov, <span class="at">plot.type =</span> <span class="st">&quot;x.scatter&quot;</span>, <span class="at">covsplit =</span> <span class="cn">TRUE</span>, <span class="at">which.cov =</span> <span class="st">&quot;sex&quot;</span> )</span>
<span id="cb56-9"><a href="examples.html#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="examples.html#cb56-10" aria-hidden="true" tabindex="-1"></a><span class="co"># ecdf</span></span>
<span id="cb56-11"><a href="examples.html#cb56-11" aria-hidden="true" tabindex="-1"></a>xsex.ecdf <span class="ot">&lt;-</span> <span class="fu">plot</span>( wcov, <span class="at">plot.type =</span> <span class="st">&quot;ecdf&quot;</span>, <span class="at">covsplit =</span> <span class="cn">TRUE</span>, <span class="at">which.cov =</span> <span class="st">&quot;sex&quot;</span> )</span>
<span id="cb56-12"><a href="examples.html#cb56-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-13"><a href="examples.html#cb56-13" aria-hidden="true" tabindex="-1"></a><span class="co"># grid plot</span></span>
<span id="cb56-14"><a href="examples.html#cb56-14" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>( <span class="at">grobs =</span> <span class="fu">list</span>( xwt.covscatt, xwt.ecdf, xsex.covscatt, xsex.ecdf ), </span>
<span id="cb56-15"><a href="examples.html#cb56-15" aria-hidden="true" tabindex="-1"></a>              <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span> )</span></code></pre></div>
<p><img src="npde_bookdown_files/figure-html/warfarinCovPlotDiagnostic-1.png" width="672" /></p>
</div>
</div>
<div id="reference-profile" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> Reference profile</h2>
<div id="reference-plot-using-one-subject" class="section level3" number="6.6.1">
<h3><span class="header-section-number">6.6.1</span> Reference plot using one subject</h3>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="examples.html#cb57-1" aria-hidden="true" tabindex="-1"></a>plot.tnpde <span class="ot">&lt;-</span> <span class="fu">plot</span>( wcov, <span class="at">plot.type =</span> <span class="st">&quot;x.scatter&quot;</span>, </span>
<span id="cb57-2"><a href="examples.html#cb57-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref.prof =</span> <span class="fu">list</span>( <span class="at">id =</span> <span class="dv">2</span> ), </span>
<span id="cb57-3"><a href="examples.html#cb57-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">main =</span> <span class="st">&quot;tnpd with reference profile ID = 2&quot;</span> )</span>
<span id="cb57-4"><a href="examples.html#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="examples.html#cb57-5" aria-hidden="true" tabindex="-1"></a>plot.vpc <span class="ot">&lt;-</span> <span class="fu">plot</span>( wcov, </span>
<span id="cb57-6"><a href="examples.html#cb57-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">plot.type =</span> <span class="st">&quot;vpc&quot;</span>, </span>
<span id="cb57-7"><a href="examples.html#cb57-7" aria-hidden="true" tabindex="-1"></a>                  <span class="at">main =</span> <span class="st">&quot;VPC&quot;</span> ) </span>
<span id="cb57-8"><a href="examples.html#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="examples.html#cb57-9" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>( <span class="at">grobs =</span> <span class="fu">list</span>( plot.tnpde, plot.vpc ), <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span> )</span></code></pre></div>
<p><img src="npde_bookdown_files/figure-html/warfarin_cov_reference_profil_one_subject-1.png" width="672" /></p>
</div>
<div id="reference-plot-using-all-subjects" class="section level3" number="6.6.2">
<h3><span class="header-section-number">6.6.2</span> Reference plot using all subjects</h3>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="examples.html#cb58-1" aria-hidden="true" tabindex="-1"></a>plot.tnpde <span class="ot">&lt;-</span> <span class="fu">plot</span>( wcov, <span class="at">plot.type =</span> <span class="st">&quot;x.scatter&quot;</span>, </span>
<span id="cb58-2"><a href="examples.html#cb58-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">ref.prof =</span> <span class="st">&quot;all&quot;</span>, <span class="at">main =</span> <span class="st">&quot;tnpd&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span> ( <span class="dv">0</span>,<span class="dv">20</span> ) )</span>
<span id="cb58-3"><a href="examples.html#cb58-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-4"><a href="examples.html#cb58-4" aria-hidden="true" tabindex="-1"></a>plot.vpc <span class="ot">&lt;-</span> <span class="fu">plot</span>( wcov, <span class="at">plot.type =</span> <span class="st">&quot;vpc&quot;</span>, <span class="at">main =</span> <span class="st">&quot;VPC&quot;</span>, <span class="at">ylim =</span> <span class="fu">c</span>( <span class="dv">0</span>, <span class="dv">20</span> ) )</span>
<span id="cb58-5"><a href="examples.html#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="examples.html#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>( <span class="at">grobs =</span> <span class="fu">list</span>( plot.tnpde, plot.vpc ), <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span> )</span></code></pre></div>
<p><img src="npde_bookdown_files/figure-html/warfarin_cov_reference_profil_all_subject-1.png" width="672" /></p>
</div>
</div>
<div id="computing-npde-in-the-presence-of-bql-data" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> Computing npde in the presence of BQL data</h2>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="examples.html#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>( virload )</span>
<span id="cb59-2"><a href="examples.html#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>( virload20 )</span>
<span id="cb59-3"><a href="examples.html#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>( virload50 )</span>
<span id="cb59-4"><a href="examples.html#cb59-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-5"><a href="examples.html#cb59-5" aria-hidden="true" tabindex="-1"></a>virload <span class="ot">&lt;-</span> <span class="fu">read.table</span>( <span class="fu">file.path</span>( fullDatDir, <span class="st">&quot;virload.tab&quot;</span> ), <span class="at">header =</span> <span class="cn">TRUE</span> )</span>
<span id="cb59-6"><a href="examples.html#cb59-6" aria-hidden="true" tabindex="-1"></a>simvirload <span class="ot">&lt;-</span> <span class="fu">read.table</span>( <span class="fu">file.path</span>( fullDatDir, <span class="st">&quot;simvirload.tab&quot;</span> ), <span class="at">header =</span> <span class="cn">TRUE</span> )</span></code></pre></div>
<div id="censoring-methods-1" class="section level4" number="6.7.0.1">
<h4><span class="header-section-number">6.7.0.1</span> Censoring methods</h4>
<p><code>cens.method = "omit"</code></p>
<p><code>cens.method = "ipred"</code></p>
<p><code>cens.method = "ppred"</code></p>
<p><code>cens.method = "cdf"</code></p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="examples.html#cb60-1" aria-hidden="true" tabindex="-1"></a>x50 <span class="ot">&lt;-</span> <span class="fu">autonpde</span>( virload50, simvirload, </span>
<span id="cb60-2"><a href="examples.html#cb60-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">iid =</span> <span class="dv">1</span>, <span class="at">ix =</span> <span class="dv">2</span>, <span class="at">iy =</span> <span class="dv">3</span>, <span class="at">icens =</span> <span class="dv">4</span>,</span>
<span id="cb60-3"><a href="examples.html#cb60-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">boolsave =</span> <span class="cn">FALSE</span>, <span class="at">units =</span> <span class="fu">list</span>( <span class="at">x =</span> <span class="st">&quot;hr&quot;</span>, <span class="at">y =</span> <span class="st">&quot;cp/mL, log 10 base&quot;</span> ) )</span></code></pre></div>
<pre><code>## ---------------------------------------------
## Distribution of npde :
##       nb of obs: 300 
##            mean= -0.06291   (SE= 0.057 )
##        variance= 0.9616   (SE= 0.079 )
##        skewness= 0.1431 
##        kurtosis= -0.1453 
## ---------------------------------------------
## Statistical tests (adjusted p-values):
##   t-test                : 0.802
##   Fisher variance test  : 1
##   SW test of normality  : 1
##   Global test           : 0.802
## ---
## Signif. codes: &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 
## ---------------------------------------------</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="examples.html#cb62-1" aria-hidden="true" tabindex="-1"></a>x50.ipred <span class="ot">&lt;-</span> <span class="fu">autonpde</span>( virload50, simvirload,</span>
<span id="cb62-2"><a href="examples.html#cb62-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">iid =</span> <span class="dv">1</span>, <span class="at">ix =</span> <span class="dv">2</span>, <span class="at">iy =</span> <span class="dv">3</span>, <span class="at">icens =</span> <span class="dv">4</span>, <span class="at">iipred =</span> <span class="dv">5</span>, </span>
<span id="cb62-3"><a href="examples.html#cb62-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">boolsave =</span> <span class="cn">FALSE</span>, <span class="at">cens.method =</span> <span class="st">&quot;ipred&quot;</span>, </span>
<span id="cb62-4"><a href="examples.html#cb62-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">units =</span> <span class="fu">list</span>( <span class="at">x =</span> <span class="st">&quot;hr&quot;</span>, <span class="at">y =</span> <span class="st">&quot;cp/mL, log 10 base&quot;</span> ) )</span></code></pre></div>
<pre><code>## ---------------------------------------------
## Distribution of npde :
##       nb of obs: 300 
##            mean= 0.02887   (SE= 0.063 )
##        variance= 1.185   (SE= 0.097 )
##        skewness= 0.04312 
##        kurtosis= -0.1197 
## ---------------------------------------------
## Statistical tests (adjusted p-values):
##   t-test                : 1
##   Fisher variance test  : 0.0924 .
##   SW test of normality  : 1
##   Global test           : 0.0924 .
## ---
## Signif. codes: &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 
## ---------------------------------------------</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="examples.html#cb64-1" aria-hidden="true" tabindex="-1"></a>x50.ppred <span class="ot">&lt;-</span> <span class="fu">autonpde</span>( virload50, simvirload,</span>
<span id="cb64-2"><a href="examples.html#cb64-2" aria-hidden="true" tabindex="-1"></a>                       <span class="at">iid =</span> <span class="dv">1</span>, <span class="at">ix =</span> <span class="dv">2</span>, <span class="at">iy =</span> <span class="dv">3</span>, <span class="at">icens =</span> <span class="dv">4</span>,</span>
<span id="cb64-3"><a href="examples.html#cb64-3" aria-hidden="true" tabindex="-1"></a>                       <span class="at">boolsave =</span> <span class="cn">FALSE</span>, <span class="at">cens.method =</span> <span class="st">&quot;ppred&quot;</span>, </span>
<span id="cb64-4"><a href="examples.html#cb64-4" aria-hidden="true" tabindex="-1"></a>                       <span class="at">units =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="st">&quot;hr&quot;</span>, <span class="at">y =</span> <span class="st">&quot;cp/mL, log 10 base&quot;</span> ) )</span></code></pre></div>
<pre><code>## ---------------------------------------------
## Distribution of npde :
##       nb of obs: 300 
##            mean= 0.02581   (SE= 0.058 )
##        variance= 0.9968   (SE= 0.082 )
##        skewness= -0.05015 
##        kurtosis= 0.8068 
## ---------------------------------------------
## Statistical tests (adjusted p-values):
##   t-test                : 1
##   Fisher variance test  : 1
##   SW test of normality  : 0.00144 **
##   Global test           : 0.00144 **
## ---
## Signif. codes: &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 
## ---------------------------------------------</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="examples.html#cb66-1" aria-hidden="true" tabindex="-1"></a>x50.omit <span class="ot">&lt;-</span> <span class="fu">autonpde</span>( virload50, simvirload,</span>
<span id="cb66-2"><a href="examples.html#cb66-2" aria-hidden="true" tabindex="-1"></a>                      <span class="at">iid =</span> <span class="dv">1</span>, <span class="at">ix =</span> <span class="dv">2</span>, <span class="at">iy =</span> <span class="dv">3</span>, <span class="at">icens =</span> <span class="dv">4</span>,</span>
<span id="cb66-3"><a href="examples.html#cb66-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">boolsave =</span> <span class="cn">FALSE</span>, <span class="at">cens.method =</span> <span class="st">&quot;omit&quot;</span>, </span>
<span id="cb66-4"><a href="examples.html#cb66-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">units =</span> <span class="fu">list</span>( <span class="at">x =</span> <span class="st">&quot;hr&quot;</span>, <span class="at">y =</span> <span class="st">&quot;cp/mL, log 10 base&quot;</span> ) )</span></code></pre></div>
<pre><code>## ---------------------------------------------
## Distribution of npde :
##       nb of obs: 169 
##            mean= 0.1417   (SE= 0.07 )
##        variance= 0.8307   (SE= 0.091 )
##        skewness= -0.05682 
##        kurtosis= -0.3378 
## ---------------------------------------------
## Statistical tests (adjusted p-values):
##   t-test                : 0.135
##   Fisher variance test  : 0.321
##   SW test of normality  : 1
##   Global test           : 0.135
## ---
## Signif. codes: &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 
## ---------------------------------------------</code></pre>
</div>
<div id="data-1" class="section level3" number="6.7.1">
<h3><span class="header-section-number">6.7.1</span> Data</h3>
<p><code>impute.loq</code> : the imputed values are plotted for data under the LOQ</p>
<p><code>line.loq</code> : horizontal line should is plotted at Y=LOQ in data and VPC plots</p>
<p><code>plot.loq</code> : data under the LOQ are plotted</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="examples.html#cb68-1" aria-hidden="true" tabindex="-1"></a>x50<span class="sc">@</span>data<span class="sc">@</span>loq</span></code></pre></div>
<pre><code>## [1] 1.7</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="examples.html#cb70-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">plot</span>( x50, <span class="at">plot.type =</span> <span class="st">&quot;data&quot;</span>, </span>
<span id="cb70-2"><a href="examples.html#cb70-2" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab =</span> <span class="st">&quot;Time (hr)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;log(Viral load) (cp/mL)&quot;</span>, </span>
<span id="cb70-3"><a href="examples.html#cb70-3" aria-hidden="true" tabindex="-1"></a>            <span class="at">line.loq =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">6.5</span>), </span>
<span id="cb70-4"><a href="examples.html#cb70-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">&quot;LOQ imputed using cdf&quot;</span> )</span>
<span id="cb70-5"><a href="examples.html#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="examples.html#cb70-6" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">plot</span>( x50, <span class="at">plot.type =</span> <span class="st">&quot;data&quot;</span>, </span>
<span id="cb70-7"><a href="examples.html#cb70-7" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab =</span> <span class="st">&quot;Time (hr)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;log(Viral load) (cp/mL)&quot;</span>, </span>
<span id="cb70-8"><a href="examples.html#cb70-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">plot.loq =</span> <span class="cn">FALSE</span>, <span class="at">line.loq =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">6.5</span>), </span>
<span id="cb70-9"><a href="examples.html#cb70-9" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">&quot;LOQ removed from plot&quot;</span> )</span>
<span id="cb70-10"><a href="examples.html#cb70-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-11"><a href="examples.html#cb70-11" aria-hidden="true" tabindex="-1"></a>x3 <span class="ot">&lt;-</span> <span class="fu">plot</span>( x50, <span class="at">plot.type =</span> <span class="st">&quot;data&quot;</span>, </span>
<span id="cb70-12"><a href="examples.html#cb70-12" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab =</span> <span class="st">&quot;Time (hr)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;log(Viral load) (cp/mL)&quot;</span>, </span>
<span id="cb70-13"><a href="examples.html#cb70-13" aria-hidden="true" tabindex="-1"></a>            <span class="at">impute.loq =</span> <span class="cn">FALSE</span>, <span class="at">line.loq =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">6.5</span>),</span>
<span id="cb70-14"><a href="examples.html#cb70-14" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">&quot;LOQ as in dataset before imputation&quot;</span> )</span>
<span id="cb70-15"><a href="examples.html#cb70-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-16"><a href="examples.html#cb70-16" aria-hidden="true" tabindex="-1"></a>x4 <span class="ot">&lt;-</span> <span class="fu">plot</span>( x50.ipred, <span class="at">plot.type =</span> <span class="st">&quot;data&quot;</span>, </span>
<span id="cb70-17"><a href="examples.html#cb70-17" aria-hidden="true" tabindex="-1"></a>            <span class="at">xlab =</span> <span class="st">&quot;Time (hr)&quot;</span>, <span class="at">ylab =</span> <span class="st">&quot;log(Viral load) (cp/mL)&quot;</span>, </span>
<span id="cb70-18"><a href="examples.html#cb70-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">line.loq =</span> <span class="cn">TRUE</span>, <span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>,<span class="fl">6.5</span>), </span>
<span id="cb70-19"><a href="examples.html#cb70-19" aria-hidden="true" tabindex="-1"></a>            <span class="at">main =</span> <span class="st">&quot;LOQ imputed to individual prediction&quot;</span> )</span>
<span id="cb70-20"><a href="examples.html#cb70-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-21"><a href="examples.html#cb70-21" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>( <span class="at">grobs =</span> <span class="fu">list</span>(x1,x2,x3,x4 ), <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">ncol =</span> <span class="dv">2</span> )</span></code></pre></div>
<p><img src="npde_bookdown_files/figure-html/virloadDataPlotCensored-1.png" width="672" /></p>
</div>
<div id="comparing-the-censoring-methods" class="section level3" number="6.7.2">
<h3><span class="header-section-number">6.7.2</span> Comparing the censoring methods</h3>
<div id="default-graphs-for-the-virload50-dataset-default-censoring-method-cdf" class="section level4" number="6.7.2.1">
<h4><span class="header-section-number">6.7.2.1</span> Default graphs for the virload50 dataset, default censoring method “cdf”</h4>
<p><img src="npde_bookdown_files/figure-html/docVirloadCensoringMethods_cdf-1.png" width="672" /></p>
</div>
<div id="default-graphs-for-the-virload50-dataset-censoring-method-omit" class="section level4" number="6.7.2.2">
<h4><span class="header-section-number">6.7.2.2</span> Default graphs for the virload50 dataset, censoring method “omit”</h4>
<p><img src="npde_bookdown_files/figure-html/docVirloadCensoringMethods_omit-1.png" width="672" /></p>
</div>
<div id="default-graphs-for-the-virload50-dataset-censoring-method-ipred" class="section level4" number="6.7.2.3">
<h4><span class="header-section-number">6.7.2.3</span> Default graphs for the virload50 dataset, censoring method “ipred”</h4>
<p><img src="npde_bookdown_files/figure-html/docVirloadCensoringMethods_ipred-1.png" width="672" /></p>
</div>
<div id="default-graphs-for-the-virload50-dataset-censoring-method-ppred" class="section level4" number="6.7.2.4">
<h4><span class="header-section-number">6.7.2.4</span> Default graphs for the virload50 dataset, censoring method “ppred”</h4>
<p><img src="npde_bookdown_files/figure-html/docVirloadCensoringMethods_ppred-1.png" width="672" /></p>
</div>
</div>
<div id="vpc-plots" class="section level3" number="6.7.3">
<h3><span class="header-section-number">6.7.3</span> VPC plots</h3>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="examples.html#cb71-1" aria-hidden="true" tabindex="-1"></a>vpc.cdf <span class="ot">=</span> <span class="fu">plot</span>( x50,<span class="at">plot.type =</span> <span class="st">&quot;vpc&quot;</span>, <span class="at">line.loq=</span><span class="cn">TRUE</span> )</span>
<span id="cb71-2"><a href="examples.html#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="examples.html#cb71-3" aria-hidden="true" tabindex="-1"></a>vpc.omit <span class="ot">=</span> <span class="fu">plot</span>( x50.omit,<span class="at">plot.type =</span> <span class="st">&quot;vpc&quot;</span> )</span>
<span id="cb71-4"><a href="examples.html#cb71-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="examples.html#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>( <span class="at">grobs =</span> <span class="fu">list</span>( vpc.omit, vpc.cdf ), <span class="at">nrow=</span><span class="dv">1</span>, <span class="at">ncol=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="npde_bookdown_files/figure-html/docVirloadVPC-1.png" width="672" /></p>
</div>
<div id="scatterplots" class="section level3" number="6.7.4">
<h3><span class="header-section-number">6.7.4</span> Scatterplots</h3>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="examples.html#cb72-1" aria-hidden="true" tabindex="-1"></a>xscatter.omit <span class="ot">&lt;-</span> <span class="fu">plot</span>( x50.omit, <span class="at">plot.type =</span> <span class="st">&quot;x.scatter&quot;</span> )</span>
<span id="cb72-2"><a href="examples.html#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="examples.html#cb72-3" aria-hidden="true" tabindex="-1"></a>xscatter.cdf <span class="ot">&lt;-</span> <span class="fu">plot</span>( x50, <span class="at">plot.type =</span> <span class="st">&quot;x.scatter&quot;</span> )</span>
<span id="cb72-4"><a href="examples.html#cb72-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-5"><a href="examples.html#cb72-5" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>( <span class="at">grobs =</span> <span class="fu">list</span>( xscatter.omit, xscatter.cdf ), <span class="at">nrow =</span> <span class="dv">1</span>, <span class="at">ncol =</span> <span class="dv">2</span> )</span></code></pre></div>
<p><img src="npde_bookdown_files/figure-html/docVirloadScatterPlot-1.png" width="672" /></p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="examples.html#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x50 , <span class="at">plot.type =</span> <span class="st">&quot;x.scatter&quot;</span>, <span class="at">plot.box =</span> <span class="cn">TRUE</span> )</span></code></pre></div>
<p><img src="npde_bookdown_files/figure-html/docVirloadScatterPlot-2.png" width="672" /></p>
</div>
<div id="plot-for-mathbbpyloq" class="section level3" number="6.7.5">
<h3><span class="header-section-number">6.7.5</span> Plot for <span class="math inline">\(\mathbb{P}(Y&lt;LOQ)\)</span></h3>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="examples.html#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># P(Y&lt;LOQ)</span></span>
<span id="cb74-2"><a href="examples.html#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="examples.html#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>( x50, <span class="at">plot.type =</span> <span class="st">&quot;loq&quot;</span>, <span class="at">main =</span> <span class="st">&quot; &quot;</span>)</span></code></pre></div>
<p><img src="npde_bookdown_files/figure-html/docVirloadPInfLOQ-1.png" width="672" /></p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="npdePackage.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="graphTypes0.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["npde_bookdown.pdf", "npde_bookdown.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
